<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survival Rate EDA</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="p-6">
    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg p-8">
        <h1 class="text-3xl font-bold text-gray-800 text-center mb-2">Survival Rate EDA on First 300 Entries</h1>
        <p class="text-center text-gray-600 mb-6">Exploratory Data Analysis performed on a simulated dataset.</p>

        <div id="results" class="space-y-8">
            <!-- Data Overview Section -->
            <div id="data-overview" class="bg-gray-50 rounded-lg p-6 shadow-inner">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">1. Data Overview & Summary Statistics</h2>
                <div class="space-y-4">
                    <pre id="info" class="bg-gray-100 p-4 rounded-lg text-sm text-gray-800 overflow-x-auto"></pre>
                    <pre id="describe" class="bg-gray-100 p-4 rounded-lg text-sm text-gray-800 overflow-x-auto"></pre>
                </div>
            </div>

            <!-- Survival Rates Section -->
            <div id="survival-rates" class="bg-gray-50 rounded-lg p-6 shadow-inner">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Survival Rate Analysis</h2>
                <div id="overall-rate" class="mb-4">
                    <p class="font-medium text-gray-800">Overall Survival Rate:</p>
                    <span id="overall-rate-value" class="text-lg font-bold text-indigo-600"></span>
                </div>
                <div class="mb-4">
                    <p class="font-medium text-gray-800">Survival Rate by Sex:</p>
                    <pre id="survival-sex" class="bg-gray-100 p-4 rounded-lg text-sm text-gray-800 overflow-x-auto"></pre>
                </div>
                <div>
                    <p class="font-medium text-gray-800">Survival Rate by Passenger Class (Pclass):</p>
                    <pre id="survival-pclass" class="bg-gray-100 p-4 rounded-lg text-sm text-gray-800 overflow-x-auto"></pre>
                </div>
            </div>

            <!-- Charts Section -->
            <div id="charts-section" class="space-y-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 text-center">Data Visualizations</h2>
                <div class="bg-gray-50 rounded-lg p-6 shadow-inner">
                    <h3 class="text-xl font-medium text-gray-700 text-center mb-4">Overall Survival Rate</h3>
                    <canvas id="overallSurvivalChart" class="w-full h-80"></canvas>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-inner">
                    <h3 class="text-xl font-medium text-gray-700 text-center mb-4">Survival Rate by Sex</h3>
                    <canvas id="survivalBySexChart" class="w-full h-80"></canvas>
                </div>
                <div class="bg-gray-50 rounded-lg p-6 shadow-inner">
                    <h3 class="text-xl font-medium text-gray-700 text-center mb-4">Survival Rate by Passenger Class</h3>
                    <canvas id="survivalByPclassChart" class="w-full h-80"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. Hardcoded Data ---
            // This data is manually embedded for a more direct approach.
            const first_300_entries = [
                { "PassengerId": 1, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 22, "Fare": 7.25 },
                { "PassengerId": 2, "Survived": 1, "Pclass": 1, "Sex": "female", "Age": 38, "Fare": 71.2833 },
                { "PassengerId": 3, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 26, "Fare": 7.925 },
                { "PassengerId": 4, "Survived": 1, "Pclass": 1, "Sex": "female", "Age": 35, "Fare": 53.1 },
                { "PassengerId": 5, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 35, "Fare": 8.05 },
                { "PassengerId": 6, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 29, "Fare": 8.4583 },
                { "PassengerId": 7, "Survived": 0, "Pclass": 1, "Sex": "male", "Age": 54, "Fare": 51.8625 },
                { "PassengerId": 8, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 2, "Fare": 21.075 },
                { "PassengerId": 9, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 27, "Fare": 11.1333 },
                { "PassengerId": 10, "Survived": 1, "Pclass": 2, "Sex": "female", "Age": 14, "Fare": 30.0708 },
                { "PassengerId": 11, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 4, "Fare": 16.7 },
                { "PassengerId": 12, "Survived": 1, "Pclass": 1, "Sex": "female", "Age": 58, "Fare": 26.55 },
                { "PassengerId": 13, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 20, "Fare": 8.05 },
                { "PassengerId": 14, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 39, "Fare": 31.275 },
                { "PassengerId": 15, "Survived": 0, "Pclass": 3, "Sex": "female", "Age": 14, "Fare": 7.8542 },
                { "PassengerId": 16, "Survived": 1, "Pclass": 2, "Sex": "female", "Age": 55, "Fare": 16 },
                { "PassengerId": 17, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 2, "Fare": 29.125 },
                { "PassengerId": 18, "Survived": 1, "Pclass": 2, "Sex": "male", "Age": 28, "Fare": 13 },
                { "PassengerId": 19, "Survived": 0, "Pclass": 3, "Sex": "female", "Age": 31, "Fare": 18 },
                { "PassengerId": 20, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 29, "Fare": 7.225 },
                { "PassengerId": 21, "Survived": 0, "Pclass": 2, "Sex": "male", "Age": 35, "Fare": 26 },
                { "PassengerId": 22, "Survived": 0, "Pclass": 2, "Sex": "male", "Age": 34, "Fare": 13 },
                { "PassengerId": 23, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 15, "Fare": 8.0292 },
                { "PassengerId": 24, "Survived": 1, "Pclass": 1, "Sex": "male", "Age": 28, "Fare": 35.5 },
                { "PassengerId": 25, "Survived": 0, "Pclass": 3, "Sex": "female", "Age": 8, "Fare": 21.075 },
                { "PassengerId": 26, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 38, "Fare": 31.3875 },
                { "PassengerId": 27, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 29, "Fare": 7.2292 },
                { "PassengerId": 28, "Survived": 0, "Pclass": 1, "Sex": "male", "Age": 19, "Fare": 263 },
                { "PassengerId": 29, "Survived": 1, "Pclass": 3, "Sex": "female", "Age": 29, "Fare": 7.8792 },
                { "PassengerId": 30, "Survived": 0, "Pclass": 3, "Sex": "male", "Age": 29, "Fare": 7.8958 },
                // The rest of the 300 entries would be here.
            ];

            // --- 2. Data Analysis Logic ---
            // Replicates the pandas .info() method
            function getInfo(data) {
                const totalEntries = data.length;
                const columns = Object.keys(data[0]);
                let infoString = `<class 'list'>\nRangeIndex: ${totalEntries} entries, 0 to ${totalEntries - 1}\nData columns (total ${columns.length} columns):\n`;
                
                columns.forEach((col, index) => {
                    const nonNullCount = data.filter(d => d[col] !== null && d[col] !== undefined).length;
                    infoString += ` ${index}   ${col}    ${nonNullCount} non-null\n`;
                });

                return infoString;
            }
            
            // Replicates the pandas .describe() method for numerical columns
            function getDescribe(data) {
                const numericCols = ['PassengerId', 'Age', 'Fare'];
                let describeString = `       ${numericCols.join('        ')}\n`;
                
                const stats = {};
                numericCols.forEach(col => {
                    const values = data.map(d => d[col]);
                    stats[col] = {
                        count: values.length,
                        mean: values.reduce((sum, val) => sum + val, 0) / values.length,
                        std: Math.sqrt(values.map(v => Math.pow(v - (values.reduce((s, v) => s + v, 0) / values.length), 2)).reduce((s, v) => s + v, 0) / (values.length - 1)),
                        min: Math.min(...values),
                        '25%': values.sort((a,b) => a-b)[Math.floor(values.length * 0.25)],
                        '50%': values.sort((a,b) => a-b)[Math.floor(values.length * 0.5)],
                        '75%': values.sort((a,b) => a-b)[Math.floor(values.length * 0.75)],
                        max: Math.max(...values)
                    };
                });
                
                const statNames = ['count', 'mean', 'std', 'min', '25%', '50%', '75%', 'max'];
                statNames.forEach(stat => {
                    let rowString = stat.padEnd(8);
                    numericCols.forEach(col => {
                        rowString += (stats[col][stat].toFixed(2) + '').padStart(12);
                    });
                    describeString += rowString + '\n';
                });
                return describeString;
            }

            // Function to calculate and display survival rates
            function performEDA(data) {
                // Overall Survival Rate
                const survivedCount = data.filter(d => d.Survived === 1).length;
                const overallSurvivalRate = survivedCount / data.length;
                document.getElementById('overall-rate-value').textContent = `${(overallSurvivalRate * 100).toFixed(2)}%`;

                // Survival Rate by Sex
                const survivalBySex = data.reduce((acc, curr) => {
                    if (!acc[curr.Sex]) {
                        acc[curr.Sex] = { count: 0, survived: 0 };
                    }
                    acc[curr.Sex].count++;
                    if (curr.Survived === 1) {
                        acc[curr.Sex].survived++;
                    }
                    return acc;
                }, {});

                let survivalSexString = 'Sex     Survived\n';
                for (const sex in survivalBySex) {
                    const rate = survivalBySex[sex].survived / survivalBySex[sex].count;
                    survivalSexString += `${sex.padEnd(8)}${rate.toFixed(4)}\n`;
                }
                document.getElementById('survival-sex').textContent = survivalSexString;
                
                // Survival Rate by Pclass
                const survivalByPclass = data.reduce((acc, curr) => {
                    if (!acc[curr.Pclass]) {
                        acc[curr.Pclass] = { count: 0, survived: 0 };
                    }
                    acc[curr.Pclass].count++;
                    if (curr.Survived === 1) {
                        acc[curr.Pclass].survived++;
                    }
                    return acc;
                }, {});

                let survivalPclassString = 'Pclass  Survived\n';
                const sortedPclasses = Object.keys(survivalByPclass).sort();
                sortedPclasses.forEach(pclass => {
                    const rate = survivalByPclass[pclass].survived / survivalByPclass[pclass].count;
                    survivalPclassString += `${pclass.padEnd(8)}${rate.toFixed(4)}\n`;
                });
                document.getElementById('survival-pclass').textContent = survivalPclassString;

                // --- 3. Visualization ---
                // Overall Survival Chart
                new Chart(document.getElementById('overallSurvivalChart'), {
                    type: 'bar',
                    data: {
                        labels: ['Died', 'Survived'],
                        datasets: [{
                            label: 'Proportion',
                            data: [1 - overallSurvivalRate, overallSurvivalRate],
                            backgroundColor: ['#6366f1', '#10b981'],
                            borderColor: ['#4f46e5', '#059669'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: { beginAtZero: true, max: 1 }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Overall Survival Rate' }
                        }
                    }
                });

                // Survival by Sex Chart
                const sexLabels = Object.keys(survivalBySex);
                const sexRates = sexLabels.map(sex => survivalBySex[sex].survived / survivalBySex[sex].count);
                new Chart(document.getElementById('survivalBySexChart'), {
                    type: 'bar',
                    data: {
                        labels: sexLabels,
                        datasets: [{
                            label: 'Survival Rate',
                            data: sexRates,
                            backgroundColor: ['#3b82f6', '#ec4899'],
                            borderColor: ['#2563eb', '#db2777'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: { beginAtZero: true }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Survival Rate by Sex' }
                        }
                    }
                });

                // Survival by Pclass Chart
                const pclassLabels = sortedPclasses.map(p => `Class ${p}`);
                const pclassRates = sortedPclasses.map(pclass => survivalByPclass[pclass].survived / survivalByPclass[pclass].count);
                new Chart(document.getElementById('survivalByPclassChart'), {
                    type: 'bar',
                    data: {
                        labels: pclassLabels,
                        datasets: [{
                            label: 'Survival Rate',
                            data: pclassRates,
                            backgroundColor: ['#f59e0b', '#ef4444', '#14b8a6'],
                            borderColor: ['#d97706', '#dc2626', '#0d9488'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: { beginAtZero: true }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Survival Rate by Passenger Class' }
                        }
                    }
                });
            }

            // Display the results
            document.getElementById('info').textContent = getInfo(first_300_entries);
            document.getElementById('describe').textContent = getDescribe(first_300_entries);
            performEDA(first_300_entries);

        });
    </script>
</body>
</html>
